window.Project=function(i,e,r,n){"use strict";var a={init:function(){r(e).on("click","#enable_serial_number",a.enable_serial_number),r(e).on("click",".woocommerce_options_panel .add-serial-number-manually, .woocommerce_options_panel .wsn-body .next-page, .woocommerce_options_panel .wsn-body .prev-page",a.add_tab_serial_number),r(e).on("click",".woocommerce_options_panel .add-serial-title",a.tab_add_serial_number_toggle),r(".ever-serial_numbers_tab").on("click",a.load_tab_data),r(e).on("click","#image_license_upload",a.upload_license_upload),r(e).on("click","#image_license_remove",a.remove_license_upload),r(e).on("change","#product",a.load_variations),r(e).on("change",".ever-panel .validity_type",a.change_validity_type),r(e).on("click",".wsn_generate_btn",a.generate_numbers),r(".ever-select").select2(),r(".ever-date, .ever-panel #validity[type=text]").datepicker()},add_tab_serial_number:function(e){e.preventDefault();var n="";"next-page"!==r(this).attr("class")&&"prev-page"!==r(this).attr("class")||(n=r(this).attr("href")),wp.ajax.send("add_serial_number",{data:{product:r("#post_ID").val(),serial_number:r(".ever-panel #serial_number").val(),image_license:r(".ever-panel #image_license").val(),deliver_times:r(".ever-panel #deliver_times").val(),max_instance:r(".ever-panel #max_instance").val(),expires_on:r(".ever-panel #expires_on").val(),validity:r(".ever-panel #validity").val(),paged_url:n},success:function(e){e.html?(r(".ever-content-placeholder").html(e.html),r(".wsn-body>input[type=hidden]").remove(),r(".ever-panel>input[type=hidden]").remove()):e.empty_serial&&r(".wsn-message").html(e.empty_serial)},error:function(e){console.log(e)}})},enable_serial_number:function(){r(".wsn-serial-number-tab").addClass("ever-spinner");var e="",n="";r(this).is(":checked")?(e="enable",n=wpwsn.i18n.serial_number_activated):(e="disable",n=wpwsn.i18n.serial_number_deactivated),r(".ever-content-placeholder").html('<div class="notice notice-success is-dismissible"><p><strong>'+n+"</strong></p></div>"),wp.ajax.send("enable_serial_number",{data:{enable_serial_number:e,post_id:r("#post_ID").val()},success:function(e){r(".wsn-serial-number-tab").removeClass("ever-spinner"),e.html&&(r(".ever-content-placeholder").html(e.html),r(".wsn-body>input[type=hidden]").remove(),r(".ever-panel>input[type=hidden]").remove())}})},load_tab_data:function(){r(".wsn-serial-number-tab").addClass("ever-spinner"),wp.ajax.send("load_tab_data",{data:{post_id:r("#post_ID").val()},success:function(e){r(".wsn-serial-number-tab").removeClass("ever-spinner"),e.html&&(r(".ever-content-placeholder").html(e.html),r(".wsn-body>input[type=hidden]").remove(),r(".ever-panel>input[type=hidden]").remove())},error:function(e){console.log(e)}})},tab_add_serial_number_toggle:function(e){e.preventDefault(),r(".ever-panel").toggle(),r(".ever-select").select2(),r(".ever-date").datepicker()},upload_license_upload:function(e){e.preventDefault();var n=wp.media({title:"Upload Image",multiple:!1}).open().on("select",function(){var e=n.state().get("selection").first().toJSON().url;r(".image_license_prev").attr("src",e),r('input[name="image_license"]').val(e),r("#image_license_remove").removeClass("hidden")})},remove_license_upload:function(e){e.preventDefault(),r(".image_license_prev").attr("src",""),r('input[name="image_license"]').val(""),r(this).addClass("hidden")},load_variations:function(e){e.preventDefault(),r(".ever-spinner-product").css("visibility","visible"),wp.ajax.send("load_variations",{data:{post_id:r(this).val()},success:function(e){console.log(e),r("#variation").html(e.html),r(".ever-spinner-product").css("visibility","hidden")},error:function(e){console.log(e)}})},change_validity_type:function(){var e=r(this).val(),n=r(".ever-panel #validity");if("days"===e)n.attr("type","number"),n.datepicker("destroy");else if("date"===e){if(n.attr("type","text"),0<r(".ever-serial_numbers_tab").length)return void n.attr("placeholder","dd-mm-yyyy");n.datepicker({dateFormat:"dd-mm-yy"})}},generate_numbers:function(e){e.preventDefault();var n=r(this).prev().prev(),a=r(this).prev().val(),t=r(this).data("rule_id");""!==a?i.confirm(wpwsn.i18n.generate_confirm+a+" numbers?")&&(n.css("display","block"),wp.ajax.send("wsn_generate_numbers",{data:{limit:a,rule_id:t},success:function(e){e.response&&(i.alert(a+wpwsn.i18n.generate_success),n.css("display","none"))},error:function(e){console.log(e)}})):i.alert(wpwsn.i18n.generate_number_validate)}};return r(e).ready(a.init),a}(window,document,jQuery);