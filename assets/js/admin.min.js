window.Project=function(t,e,i,n){"use strict";var a={init:function(){i(e).on("click","#enable_serial_number",a.enable_serial_number),i(e).on("click",".woocommerce_options_panel .add-serial-number-manually",a.add_tab_serial_number),i(e).on("click",".woocommerce_options_panel .add-serial-title",a.tab_add_serial_number_toggle),i(".ever-serial_numbers_tab").on("click",a.load_tab_data),i(e).on("click",".woocommerce_options_panel .wsn-body .next-page",a.pagination_load_tab_data),i(e).on("click","#image_license_upload",a.upload_license_upload),i(e).on("click","#image_license_remove",a.remove_license_upload),i(e).on("change","#product",a.load_variations),i(e).on("change",".ever-panel .validity_type",a.change_validity_type),i(e).on("click",".wsn_generate_btn",a.generate_numbers),i(".ever-select").select2(),i(".ever-date, .ever-panel #validity[type=text]").datepicker()},add_tab_serial_number:function(e){e.preventDefault(),wp.ajax.send("add_serial_number",{data:{product:i("#post_ID").val(),serial_number:i(".ever-panel #serial_number").val(),image_license:i(".ever-panel #image_license").val(),deliver_times:i(".ever-panel #deliver_times").val(),max_instance:i(".ever-panel #max_instance").val(),expires_on:i(".ever-panel #expires_on").val(),validity:i(".ever-panel #validity").val()},success:function(e){e.html?i(".ever-content-placeholder").html(e.html):e.empty_serial&&i(".wsn-message").html(e.empty_serial)},error:function(e){console.log(e)}})},enable_serial_number:function(){i(".wsn-serial-number-tab").addClass("ever-spinner");var e="",n="";i(this).is(":checked")?(e="enable",n=wpwsn.i18n.serial_number_activated):(e="disable",n=wpwsn.i18n.serial_number_deactivated),i(".ever-content-placeholder").html('<div class="notice notice-success is-dismissible"><p><strong>'+n+"</strong></p></div>"),wp.ajax.send("enable_serial_number",{data:{enable_serial_number:e,post_id:i("#post_ID").val()},success:function(e){i(".wsn-serial-number-tab").removeClass("ever-spinner"),e.html&&(i(".ever-content-placeholder").html(e.html),i(".wsn-body>input[type=hidden]").remove(),i(".ever-panel>input[type=hidden]").remove())}})},load_tab_data:function(){i(".wsn-serial-number-tab").addClass("ever-spinner"),wp.ajax.send("load_tab_data",{data:{post_id:i("#post_ID").val()},success:function(e){i(".wsn-serial-number-tab").removeClass("ever-spinner"),e.html&&(i(".ever-content-placeholder").html(e.html),i(".wsn-body>input[type=hidden]").remove(),i(".ever-panel>input[type=hidden]").remove())},error:function(e){console.log(e)}})},pagination_load_tab_data:function(e){e.preventDefault()},tab_add_serial_number_toggle:function(e){e.preventDefault(),i(".ever-panel").toggle(),i(".ever-select").select2(),i(".ever-date").datepicker()},upload_license_upload:function(e){e.preventDefault();var n=wp.media({title:"Upload Image",multiple:!1}).open().on("select",function(){var e=n.state().get("selection").first().toJSON().url;i(".image_license_prev").attr("src",e),i('input[name="image_license"]').val(e),i("#image_license_remove").removeClass("hidden")})},remove_license_upload:function(e){e.preventDefault(),i(".image_license_prev").attr("src",""),i('input[name="image_license"]').val(""),i(this).addClass("hidden")},load_variations:function(e){e.preventDefault(),i(".ever-spinner-product").css("visibility","visible"),wp.ajax.send("load_variations",{data:{post_id:i(this).val()},success:function(e){console.log(e),i("#variation").html(e.html),i(".ever-spinner-product").css("visibility","hidden")},error:function(e){console.log(e)}})},change_validity_type:function(){var e=i(this).val(),n=i(".ever-panel #validity");if("days"===e)n.attr("type","number"),n.datepicker("destroy");else if("date"===e){if(n.attr("type","text"),0<i(".ever-serial_numbers_tab").length)return void n.attr("placeholder","dd-mm-yyyy");n.datepicker({dateFormat:"dd-mm-yy"})}},generate_numbers:function(e){e.preventDefault();var n=i(this).prev().val(),a=i(this).data("rule_id");t.confirm(wpwsn.i18n.generate_confirm+n+" numbers?")&&wp.ajax.send("wsn_generate_numbers",{data:{limit:n,rule_id:a},success:function(e){e.response&&t.alert(n+wpwsn.i18n.generate_success)},error:function(e){console.log(e)}})}};return i(e).ready(a.init),a}(window,document,jQuery);